(function(){var L=function(){var a=["0","0","0"];return function(){for(var b=a.length,c;b;){b--;c=a[b].charCodeAt(0);if(57==c)return a[b]="A",a.join("");if(90==c)a[b]="0";else return a[b]=String.fromCharCode(c+1),a.join("")}a.unshift("0");return a.join("")}}(),u=Object.prototype.toString,q=function(a){var b;if(b=a&&null!=a&&"object"===typeof a)b=a.length,b="number"==typeof b&&!isNaN(b);return!(!b||"[object Array]"!=u.call(a))},D=function(a){return"[object Date]"===u.call(a)},z=function(a){return"function"===
typeof a},E=function(a){return"[object RegExp]"===u.call(a)},F=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},v=function(a){return"string"==typeof a},r=function(){return String.prototype.trim?function(a){return v(a)?a.trim():a}:function(a){return v(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),w=function(){},x=Array.prototype.slice,G=function(a){return"undefined"==typeof a},H=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,
arguments)}},M=function(){this.events={}};M.prototype={createEvent:function(a,b){a=a.toLowerCase();var c=this.events;c[a]||(c[a]=new s(a,b));return c[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,b,c,d){a=a.toLowerCase();var e=this.events;e[a]||(e[a]=new s(a));return e[a].on(b,c,d)},once:function(a,b,c,d){d=d||{};d.limit=1;return this.on(a,b,c,d)},un:function(a,b,c){a=a.toLowerCase();var d=this.events;d[a]&&d[a].un(b,c)},hasListener:function(a,b,c){a=a.toLowerCase();
var d=this.events;return d[a]?d[a].hasListener(b,c):!1},removeAllListeners:function(a){var b=this.events;b[a]&&b[a].removeAllListeners()},trigger:function(){var a=arguments[0],b=this.events,a=a.toLowerCase();if(!b[a])return null;a=b[a];return a.trigger.apply(a,x.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].suspend()},suspendAllEvents:function(){var a=this.events,b;for(b in a)a[b].suspend()},resumeEvent:function(a){a=a.toLowerCase();var b=this.events;
b[a]&&b[a].resume()},resumeAllEvents:function(){var a=this.events,b;for(b in a)a[b].resume()},destroyEvent:function(a){var b=this.events;b[a]&&(b[a].removeAllListeners(),b[a].destroy(),delete b[a])},destroy:function(a){var b=this.events;if(a)a=a.toLowerCase(),b[a]&&(b[a].destroy(),delete b[a]);else{for(var c in b)b[c].destroy();this.events={}}},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),
b={},c,d=-1,e=a.length;++d<e;c=a[d],b[c]=H(this[c],this));this.api=b}return this.api}};var s=function(a,b){this.name=a;this.listeners=[];this.map={};this.hash=L();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=G(b)?null:b};s.prototype={getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(a,b,c){if(!a)return null;b=b||null;c=c||{};var d=this.uni,e=b||a;if(e[d]&&!c.allowDupes)return null;var k=++this.lid,l=c.first||!1;e[d]=k;
a={fn:a,scope:b,uniScope:e,id:k,called:0,limit:c.limit||0,start:c.start||1,count:0,append:c.append,prepend:c.prepend};l?this.listeners.unshift(a):this.listeners.push(a);this.map[k]=a;return k},once:function(a,b,c){c=c||{};c.once=!0;return this.on(a,b,c)},un:function(a,b){var c=-1,d=this.uni,e=this.listeners,k;k=a==parseInt(a)?a:(b||a)[d];if(!k)return!1;for(var l=0,q=e.length;l<q;l++)if(e[l].id==k){c=l;delete e[l].uniScope[d];break}if(-1==c)return!1;e.splice(c,1);delete this.map[k];return!0},hasListener:function(a,
b){var c=this.listeners,d;if(a){b=b||a;d=z(a)?b[this.uni]:a;if(!d)return!1;for(var e=0,k=c.length;e<k;e++)if(c[e].id==d)return!0;return!1}return 0<c.length},removeAllListeners:function(){var a=this.listeners,b=this.uni,c,d;c=0;for(d=a.length;c<d;c++)delete a[c].uniScope[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,b){var c;a.append||a.prepend?(c=x.call(b),a.prepend&&(c=a.prepend.concat(c)),a.append&&(c=c.concat(a.append))):
c=b;return c},trigger:function(){var a=this.listeners,b=this.returnResult;if(this.suspended||0==a.length)return null;for(var c="all"==b?[]:null,d,e,a="first"==b?[a[0]]:x.call(a);d=a.shift();)if(d&&this.map[d.id]&&(d.count++,!(d.count<d.start))){e=d.fn.apply(d.scope,this._prepareArgs(d,arguments));d.called++;d.called==d.limit&&this.un(d.id);"all"==b&&c.push(e);if("first"==b)return e;"last"==b&&(c=e);if(!1==b&&!1===e)break}if(b)return c}};var y;y=function(){var a=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,b=function(n){if(!v(n))return!0;
var a=n.substr(0,1),m=n.length-1;return'"'!=a&&"'"!=a||n.indexOf(a,1)!=m?!1:n.substring(1,m)},c=function(n,a){if(F(n))throw Error("Cannot copy window object");if(a){if(n===a)throw Error("Objects are identical");if(q(n))for(var m=a.length=0;m<n.length;m++)a.push(c(n[m]));else{for(m in a)delete a[m];for(m in n)a[m]=c(n[m])}}else(a=n)&&(q(n)?a=c(n,[]):D(n)?a=new Date(n.getTime()):E(n)?a=new RegExp(n.source):null!=n&&"object"===typeof n&&(a=c(n,{})));return a},d=function(a,g){if(a===g)return!0;if(null===
a||null===g)return!1;if(a!==a&&g!==g)return!0;var m=typeof a,b;if(m==typeof g&&"object"==m)if(q(a)){if(!q(g))return!1;if((m=a.length)==g.length){for(b=0;b<m;b++)if(!d(a[b],g[b]))return!1;return!0}}else{if(D(a))return D(g)&&a.getTime()==g.getTime();if(E(a)&&E(g))return a.toString()==g.toString();if(F(a)||F(g)||q(g))return!1;m={};for(b in a)if(("$"!==b.charAt(0)||"object"!=typeof a[b])&&!z(a[b])){if(!d(a[b],g[b]))return!1;m[b]=!0}for(b in g)if(!m.hasOwnProperty(b)&&"$"!==b.charAt(0)&&void 0!==g[b]&&
!z(g[b]))return!1;return!0}return!1},e=function(a,g){var b=a.length,c=g.length,p=Array(b+1),t=Array(b+1),f,h,e,k,l=0;if(b==c&&0==b)return{changes:0,distance:0,prescription:[]};for(f=0;f<=b;f++)p[f]=Array(c+1),t[f]=Array(c+1),p[f][0]=f,t[f][0]="D";for(f=0;f<=c;f++)p[0][f]=f,t[0][f]="I";for(f=1;f<=b;f++)for(h=1;h<=c;h++)e=d(a[f-1],g[h-1])?0:1,p[f][h-1]<p[f-1][h]&&p[f][h-1]<p[f-1][h-1]+e?(p[f][h]=p[f][h-1]+1,t[f][h]="I"):p[f-1][h]<p[f-1][h-1]+e?(p[f][h]=p[f-1][h]+1,t[f][h]="D"):(p[f][h]=p[f-1][h-1]+
e,t[f][h]=1==e?"R":"-");k=[];f=b;h=c;do e=t[f][h],k.push(e),"-"!=e&&l++,"R"==e||"-"==e?(f--,h--):"D"==e?f--:h--;while(0!=f||0!=h);return{changes:l/k.length,distance:p[b][c],prescription:k.reverse()}},k,l=function(a,g,m,c,p,d){k||(k=new M);var f=L(),h;d&&(this.namespace=d,this.nsGet=d.get);this.origCode=g;q(a)&&null===g?h="array":(v(g)||(c=m,m=g,g=null,h="object"),v(a)&&(c=m,m=g,g=a,a=null),g&&a&&(h=a.hasOwnProperty(g)?"attr":"expr"),g&&!a&&(h="expr"));if(m)k.on(f,m,c||this,{append:[p],allowDupes:!0});
if("expr"==h){g=this._processInputPipes(g,a);g=this._processPipes(g,a);if(this.inputPipes||this.pipes)g=s(a,g),h=a.hasOwnProperty(g)?"attr":"expr";if(this.staticValue=b(g))h="static"}this.userData=p;this.code=g;this.id=f;this.type=h;this.obj=a;"expr"==h&&(this.getterFn=I(g));this.curr=this._getValue()};l.prototype={namespace:null,nsGet:null,staticValue:null,origCode:null,code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,pipes:null,inputPipes:null,lastSetValue:null,
userData:null,_processInputPipes:function(a,g){if(-1==a.indexOf(">>"))return a;for(var b=0,c=a.length,d=[],e,f,h,k=a;b<c&&-1!=(e=a.indexOf(">>",b));)f=a.charAt(e-1),h=a.charAt(e+2),"\\"!=f&&"'"!=f&&'"'!=f&&"'"!=h&&'"'!=h&&(b=r(a.substring(b,e)).split(":"),k=a.substr(e+2),this._addPipe(d,b,g,this.onInputParamChange)),b=e+2;d.length&&(this.inputPipes=d);return r(k)},_addPipe:function(a,g,b,c){var d=g.shift(),e=null,f=[],h;this.nsGet&&(e=this.nsGet("filter."+d,!0));e||(e=window[d]||b[d]);if(z(e)){d=
-1;for(h=g.length;++d<h;f.push(u(b,g[d],c,this,null,this.namespace)));a.push([e,g,f])}},_processPipes:function(a,g){if(-1==a.indexOf("|"))return a;for(var b=0,c=a.length,d=[],e,f,h,k=!1,l=a;b<c;)if(-1!=(e=a.indexOf("|",b)))f=a.charAt(e-1),h=a.charAt(e+1),"|"!=f&&"'"!=f&&'"'!=f&&"|"!=h&&"'"!=h&&'"'!=h&&(k?(b=r(a.substring(b,e)).split(":"),this._addPipe(d,b,g)):(k=!0,l=r(a.substring(0,e)))),b=e+1;else{k&&(b=r(a.substr(b)).split(":"),this._addPipe(d,b,g,this.onPipeParamChange));break}d.length&&(this.pipes=
d);return l},_checkCode:function(){var a=this._getValue(),b=!1,c=this.curr;if(q(c)&&q(a))return b=e(c,a),b.changes?(this.curr=a.slice(),k.trigger(this.id,b,a,c),!0):!1;a!==c&&(this.curr=a,k.trigger(this.id,a,c),b=!0);return b},_checkObject:function(){var a=this.obj,b=this.curr;return d(b,a)?!1:(this.curr=c(a),k.trigger(this.id,a,b),!0)},_checkArray:function(){var a=this.curr,b=this.obj,c=e(a,b);return c.changes?(this.curr=b.slice(),k.trigger(this.id,c,b,a),!0):!1},_getValue:function(){var a;switch(this.type){case "static":a=
this.staticValue;break;case "attr":a=this.obj[this.code];break;case "expr":a=this.getterFn(this.obj);G(a)&&(a="");break;case "object":a=c(this.obj);break;case "array":a=this.obj}q(a)&&(a=a.slice());return a=this._runThroughPipes(a,this.pipes)},_runThroughPipes:function(a,b){if(b){var c,d,e,k=b.length,f=this.obj,h,l;for(c=0;c<k;c++){e=b[c][1];d=[];h=-1;for(l=e.length;++h<l;d.push(N(e[h],f)));d.unshift(f);d.unshift(a);a=b[c][0].apply(null,d)}}return a},subscribe:function(a,b,c){k.on(this.id,a,b,c)},
unsubscribe:function(a,b){return k.un(this.id,a,b)},hasPipes:function(){return null!==this.pipes},hasInputPipes:function(){return null!=this.inputPipes},getValue:function(){return this._getValue()},setValue:function(a){var b=this.type;this.lastSetValue=a;a=this._runThroughPipes(a,this.inputPipes);if("attr"==b)this.obj[this.code]=a;else if("expr"==b)this.setterFn||(this.setterFn=O(this.code)),this.setterFn(this.obj,a);else if("array"==b)this.obj=a;else throw"Cannot set value";},onInputParamChange:function(){this.setValue(this.lastSetValue)},
onPipeParamChange:function(){this.check()},check:function(){switch(this.type){case "expr":case "attr":case "static":return this._checkCode();case "object":return this._checkObject();case "array":return this._checkArray()}return!1},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=this;b.itv&&b.clearInterval();b.itv=setInterval(function(){b.check()},a)},clearInterval:function(){this.itv&&(clearInterval(this.itv),this.itv=
null)},unsubscribeAndDestroy:function(a,b){var c=this.id;k.un(c,a,b);return k.hasListener(c)?!1:(this.destroy(),!0)},destroy:function(){var a=this.pipes,b=this.inputPipes,c,d,e,l,f;this.itv&&this.clearInterval();if(a)for(c=-1,d=a.length;++c<d;)for(f=a[c][2],e=-1,l=f.length;++e<l;)f[e].unsubscribeAndDestroy(this.check,this);if(b)for(c=-1,d=b.length;++c<d;)for(f=b[c][2],e=-1,l=f.length;++e<l;)f[e].unsubscribeAndDestroy(this.onInputParamChange,this);this.obj&&delete this.obj.$$watchers[this.origCode];
delete this.id;delete this.curr;delete this.obj;delete this.pipes;delete this.inputPipes;delete this.origCode;delete this.code;delete this.getterFn;delete this.setterFn;delete this.lastSetValue;delete this.staticValue;delete this.userData;delete this.namespace;delete this.nsGet;k.destroyEvent(this.id)}};var u=function(a,b,c,d,e,k){b=s(a,r(b));return a?(a.$$watchers||(a.$$watchers={$checkAll:function(){var a,b=0;for(a in this)"$"!=a.charAt(0)&&this[a].check()?b++:"$"==a.charAt(0)&&this[a]instanceof
l&&this[a].check()&&b++;return b},$destroyAll:function(){for(var a in this)if("$"!=a.charAt(0)||this[a]instanceof l)this[a].destroy(),delete this[a]}}),a.$$watchers[b]?a.$$watchers[b].subscribe(c,d,{append:[e],allowDupes:!0}):a.$$watchers[b]=new l(a,b,c,d,e,k),a.$$watchers[b]):new l(a,b,c,d,e,k)},s=function(a,b){if(a&&b){if(a.hasOwnProperty(b))return b;var c;if("."==b.charAt(0)&&(c=b.substr(1),a.hasOwnProperty(c)))return c}return b},J=Function,y=function(a,b,c,d){for(;c&&!c.$isRoot;)if(c=c.$parent)try{return 4==
arguments.length?b.call(null,c,d,w,b):b.call(null,c,w,b)}catch(e){}},K=function(a){return function(){var b=x.call(arguments);b.push(y);b.push(a);var c=b=a.apply(null,b);return G(c)||!c&&"number"==typeof c&&isNaN(c)?(b=x.call(arguments),b.unshift(a),b.unshift(null),y.apply(null,b)):b}},A={},P=0,I=function(b){try{return A[b]?A[b]:(P++,A[b]=K(new J("____","$$interceptor","$$itself","".concat("try {","return ",b.replace(a,"$1____.$3"),";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }"))))}catch(c){return w}},
B={},Q=0,O=function(b){try{if(!B[b]){Q++;var c=b.replace(a,"$1____.$3");return B[b]=K(new J("____","$$$$","$$interceptor","$$itself","".concat("try {",c," = $$$$",";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____, $$$$); }")))}return B[b]}catch(d){return w}},C={},R=0,N=function(a,c){var d;return(d=b(a))?d:I(a)(c)},H=function(){1E3<=P&&(A={});1E3<=Q&&(B={});1E3<=R&&(C={})};l.create=u;l.unsubscribeAndDestroy=function(a,b,c,d){b=r(b);(a=a.$$watchers)&&a[b]&&a[b].unsubscribeAndDestroy(c,
d)&&delete a[b]};l.normalizeExpr=s;l.prepareCode=function(b){return b.replace(a,"$1____.$3")};l.createGetter=I;l.createSetter=O;l.createFunc=function(b){try{return C[b]?C[b]:(R++,C[b]=K(new J("____","$$interceptor","$$itself","".concat("try {",b.replace(a,"$1____.$3"),";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }"))))}catch(c){return w}};l.eval=N;l.enableResetCacheInterval=function(){setTimeout(H,1E4)};return l}();MetaphorJs.lib.Watchable=y;"undefined"!=typeof global?
global.MetaphorJs=MetaphorJs:window.MetaphorJs=MetaphorJs})();
