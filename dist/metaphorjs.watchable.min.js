(function(){var A=function(){var a=["0","0","0"];return function(){for(var b=a.length,c;b;){b--;c=a[b].charCodeAt(0);if(57==c)return a[b]="A",a.join("");if(90==c)a[b]="0";else return a[b]=String.fromCharCode(c+1),a.join("")}a.unshift("0");return a.join("")}}(),B=Object.prototype.toString,f=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(b){if(!b){if(null===
b)return 6;if(void 0===b)return 7}var c=a[B.call(b)];if(void 0===c)return-1;1==c&&isNaN(b)&&(c=8);return c}}(),l=function(a){return 5===f(a)},v=function(a){return"function"==typeof a},p=function(){return String.prototype.trim?function(a){return 0===f(a)?a.trim():a}:function(a){return 0===f(a)?a.replace(/^\s\s*/,"").replace(/\s\s*$/,""):a}}(),s=function(){},t=Array.prototype.slice,r=function(a){return a&&a.document&&a.location&&a.alert&&a.setInterval},C=function(){var a=function(b,c){if(b===c)return!0;
if(null===b||null===c)return!1;if(b!==b&&c!==c)return!0;var e=typeof b,d;if(e==typeof c&&"object"==e)if(l(b)){if(!l(c))return!1;if((e=b.length)==c.length){for(d=0;d<e;d++)if(!a(b[d],c[d]))return!1;return!0}}else{if(10===f(b))return 10===f(c)&&b.getTime()==c.getTime();if(9===f(b)&&9===f(c))return b.toString()==c.toString();if(r(b)||r(c)||l(c))return!1;e={};for(d in b)if(("$"!==d.charAt(0)||"object"!=typeof b[d])&&!v(b[d])){if(!a(b[d],c[d]))return!1;e[d]=!0}for(d in c)if(!e.hasOwnProperty(d)&&"$"!==
d.charAt(0)&&void 0!==c[d]&&!v(c[d]))return!1;return!0}return!1};return a}(),F=function(){var a=function(b,c){if(r(b))throw Error("Cannot copy window object");if(c){if(b===c)throw Error("Objects are identical");if(l(b))for(var e=c.length=0;e<b.length;e++)c.push(a(b[e]));else{for(e in c)delete c[e];for(e in b)c[e]=a(b[e])}}else if(c=b)l(b)?c=a(b,[]):10===f(b)?c=new Date(b.getTime()):9===f(b)?c=new RegExp(b.source):(e=f(b),null!==b&&"object"==typeof b&&(2<e||-1==e)&&(c=a(b,{})));return c};return a}(),
N=function(a,b,c){setTimeout(function(){a.apply(b,c||[])},0)},w=function(a){var b=a.stack||Error().stack;if("undefined"!=typeof console&&console.log)N(function(){console.log(a);b&&console.log(b)});else throw a;},O=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,arguments)}},G=function(){this.events={}};G.prototype={createEvent:function(a,b){a=a.toLowerCase();var c=this.events;c[a]||(c[a]=new q(a,b));return c[a]},getEvent:function(a){a=a.toLowerCase();
return this.events[a]},on:function(a,b,c,e){a=a.toLowerCase();var d=this.events;d[a]||(d[a]=new q(a));return d[a].on(b,c,e)},once:function(a,b,c,e){e=e||{};e.limit=1;return this.on(a,b,c,e)},un:function(a,b,c){a=a.toLowerCase();var e=this.events;e[a]&&e[a].un(b,c)},hasListener:function(a,b,c){a=a.toLowerCase();var e=this.events;return e[a]?e[a].hasListener(b,c):!1},removeAllListeners:function(a){var b=this.events;b[a]&&b[a].removeAllListeners()},trigger:function(){var a=arguments[0],b=this.events,
a=a.toLowerCase();if(!b[a])return null;a=b[a];return a.trigger.apply(a,t.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].suspend()},suspendAllEvents:function(){var a=this.events,b;for(b in a)a[b].suspend()},resumeEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].resume()},resumeAllEvents:function(){var a=this.events,b;for(b in a)a[b].resume()},destroyEvent:function(a){var b=this.events;b[a]&&(b[a].removeAllListeners(),b[a].destroy(),delete b[a])},
destroy:function(a){var b=this.events;if(a)a=a.toLowerCase(),b[a]&&(b[a].destroy(),delete b[a]);else{for(var c in b)b[c].destroy();this.events={}}},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),b={},c,e=-1,d=a.length;++e<d;c=a[e],b[c]=O(this[c],this));this.api=b}return this.api}};var q=function(a,b){this.name=a;this.listeners=[];this.map={};this.hash=
A();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;this.returnResult=void 0===b?null:b};q.prototype={getName:function(){return this.name},destroy:function(){this.map=this.listeners=null},on:function(a,b,c){if(!a)return null;b=b||null;c=c||{};var e=this.uni,d=b||a;if(d[e]&&!c.allowDupes)return null;var f=++this.lid,m=c.first||!1;d[e]=f;a={fn:a,scope:b,uniScope:d,id:f,called:0,limit:c.limit||0,start:c.start||1,count:0,append:c.append,prepend:c.prepend};m?this.listeners.unshift(a):this.listeners.push(a);
this.map[f]=a;return f},once:function(a,b,c){c=c||{};c.once=!0;return this.on(a,b,c)},un:function(a,b){var c=-1,e=this.uni,d=this.listeners,f;f=a==parseInt(a)?a:(b||a)[e];if(!f)return!1;for(var m=0,l=d.length;m<l;m++)if(d[m].id==f){c=m;delete d[m].uniScope[e];break}if(-1==c)return!1;d.splice(c,1);delete this.map[f];return!0},hasListener:function(a,b){var c=this.listeners,e;if(a){b=b||a;e=v(a)?b[this.uni]:a;if(!e)return!1;for(var d=0,f=c.length;d<f;d++)if(c[d].id==e)return!0;return!1}return 0<c.length},
removeAllListeners:function(){var a=this.listeners,b=this.uni,c,e;c=0;for(e=a.length;c<e;c++)delete a[c].uniScope[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,b){var c;a.append||a.prepend?(c=t.call(b),a.prepend&&(c=a.prepend.concat(c)),a.append&&(c=c.concat(a.append))):c=b;return c},trigger:function(){var a=this.listeners,b=this.returnResult;if(this.suspended||0==a.length)return null;for(var c="all"==b?[]:null,
e,d,a="first"==b?[a[0]]:t.call(a);e=a.shift();)if(e&&this.map[e.id]&&(e.count++,!(e.count<e.start))){d=e.fn.apply(e.scope,this._prepareArgs(e,arguments));e.called++;e.called==e.limit&&this.un(e.id);"all"==b&&c.push(d);if("first"==b)return d;"last"==b&&(c=d);if(!1==b&&!1===d)break}if(b)return c}};var u;u=function(){var a=/(^|[^a-z0-9_$])(\.)([^0-9])/ig,b=function(a){if(0!==f(a))return!0;var b=a.substr(0,1),n=a.length-1;return'"'!=b&&"'"!=b||a.indexOf(b,1)!=n?!1:a.substring(1,n)},c=function(a,b){var n=
a.length,c=b.length,e=Array(n+1),d=Array(n+1),g,h,f,l,m=0;if(n==c&&0==n)return{changes:0,distance:0,prescription:[]};for(g=0;g<=n;g++)e[g]=Array(c+1),d[g]=Array(c+1),e[g][0]=g,d[g][0]="D";for(g=0;g<=c;g++)e[0][g]=g,d[0][g]="I";for(g=1;g<=n;g++)for(h=1;h<=c;h++)f=C(a[g-1],b[h-1])?0:1,e[g][h-1]<e[g-1][h]&&e[g][h-1]<e[g-1][h-1]+f?(e[g][h]=e[g][h-1]+1,d[g][h]="I"):e[g-1][h]<e[g-1][h-1]+f?(e[g][h]=e[g-1][h]+1,d[g][h]="D"):(e[g][h]=e[g-1][h-1]+f,d[g][h]=1==f?"R":"-");l=[];g=n;h=c;do f=d[g][h],l.push(f),
"-"!=f&&m++,"R"==f||"-"==f?(g--,h--):"D"==f?g--:h--;while(0!=g||0!=h);return{changes:m/l.length,distance:e[n][c],prescription:l.reverse()}},e,d=function(a,c,n,d,H,k){e||(e=new G);var g=A(),h;k&&(this.namespace=k,this.nsGet=k.get);this.origCode=c;l(a)&&null===c?h="array":(0!==f(c)&&(d=n,n=c,c=null,h="object"),0===f(a)&&(d=n,n=c,c=a,a=null),c&&a&&(h=a.hasOwnProperty(c)?"attr":"expr"),c&&!a&&(h="expr"));if(n)e.on(g,n,d||this,{append:[H],allowDupes:!0});if("expr"==h){c=this._processInputPipes(c,a);c=
this._processPipes(c,a);if(this.inputPipes||this.pipes)c=m(a,c),h=a.hasOwnProperty(c)?"attr":"expr";if(this.staticValue=b(c))h="static"}this.userData=H;this.code=c;this.id=g;this.type=h;this.obj=a;"expr"==h&&(this.getterFn=D(c));this.curr=this._getValue()};d.prototype={namespace:null,nsGet:null,staticValue:null,origCode:null,code:null,getterFn:null,setterFn:null,id:null,type:null,obj:null,itv:null,curr:null,prev:null,unfiltered:null,pipes:null,inputPipes:null,lastSetValue:null,userData:null,_indexArrayItems:function(a){var b=
"$$"+this.id,c,e,d;if(a)for(c=0,e=a.length;c<e;c++){d=a[c];var k;if(k=d)k=f(d),k=!(3>k&&-1<k);k&&!d[b]&&(d[b]=A())}},_processInputPipes:function(a,b){if(-1==a.indexOf(">>"))return a;for(var c=0,e=a.length,d=[],k,g,h,f=a;c<e&&-1!=(k=a.indexOf(">>",c));)g=a.charAt(k-1),h=a.charAt(k+2),"\\"!=g&&"'"!=g&&'"'!=g&&"'"!=h&&'"'!=h&&(c=p(a.substring(c,k)).split(":"),f=a.substr(k+2),this._addPipe(d,c,b,this.onInputParamChange)),c=k+2;d.length&&(this.inputPipes=d);return p(f)},_addPipe:function(a,c,b,e){var d=
c.shift(),k=null,g=[],h;this.nsGet&&(k=this.nsGet("filter."+d,!0));k||(k=window[d]||b[d]);if(v(k)){d=-1;for(h=c.length;++d<h;g.push(r(b,c[d],e,this,null,this.namespace)));a.push([k,c,g])}},_processPipes:function(a,c){if(-1==a.indexOf("|"))return a;for(var b=0,e=a.length,d=[],k,g,h,f=!1,l=a;b<e;)if(-1!=(k=a.indexOf("|",b)))g=a.charAt(k-1),h=a.charAt(k+1),"|"!=g&&"'"!=g&&'"'!=g&&"|"!=h&&"'"!=h&&'"'!=h&&(f?(b=p(a.substring(b,k)).split(":"),this._addPipe(d,b,c)):(f=!0,l=p(a.substring(0,k)))),b=k+1;else{f&&
(b=p(a.substr(b)).split(":"),this._addPipe(d,b,c,this.onPipeParamChange));break}d.length&&(this.pipes=d);return l},_checkCode:function(){var a=this._getValue(),b=!1,d=this.curr;if(l(d)&&l(a))return b=c(d,a),b.changes?(this.curr=a.slice(),this.prev=d,e.trigger(this.id,b,a,d),!0):!1;C(d,a)||(this.curr=a,this.prev=d,e.trigger(this.id,a,d),b=!0);return b},_checkObject:function(){var a=this.obj,b=this.curr;return C(b,a)?!1:(this.curr=F(a),this.prev=b,e.trigger(this.id,a,b),!0)},_checkArray:function(){var a=
this.curr,b=this.obj,d=c(a,b);return d.changes?(this.curr=b.slice(),this.prev=a,e.trigger(this.id,d,b,a),!0):!1},_getValue:function(){var a;switch(this.type){case "static":a=this.staticValue;break;case "attr":a=this.obj[this.code];break;case "expr":a=this.getterFn(this.obj);void 0===a&&(a="");break;case "object":a=F(this.obj);break;case "array":a=this.obj}l(a)&&(this.inputPipes||this._indexArrayItems(a),a=a.slice());this.unfiltered=a;return a=this._runThroughPipes(a,this.pipes)},_runThroughPipes:function(a,
b){if(b){var c,d,e,k=b.length,g=this.obj,h,f;for(c=0;c<k;c++){e=b[c][1];d=[];h=-1;for(f=e.length;++h<f;d.push(I(e[h],g)));d.unshift(g);d.unshift(a);a=b[c][0].apply(null,d)}}return a},subscribe:function(a,b,c){e.on(this.id,a,b,c)},unsubscribe:function(a,b){return e.un(this.id,a,b)},hasPipes:function(){return null!==this.pipes},hasInputPipes:function(){return null!=this.inputPipes},getValue:function(){return this._getValue()},getUnfilteredValue:function(){return this.unfiltered||this.curr},getPrevValue:function(){return null===
this.prev?this._getValue():this.prev},getMovePrescription:function(a,b){var c=this.getPrevValue(),d=this.curr,e=[],f,g,h={},l,m,p;f=0;for(g=c.length;f<g;f++)h[b(c[f])]=f;m=0;var q={};l=0;for(g=a.length;l<g;l++)f=a[l],"D"!=f&&(c=b(d[m]),void 0!==c&&!0!==q[c]&&void 0!==(p=h[c])?(e.push(p),q[c]=!0):e.push(f),m++);return e},setValue:function(a){var b=this.type;this.lastSetValue=a;a=this._runThroughPipes(a,this.inputPipes);if("attr"==b)this.obj[this.code]=a;else if("expr"==b)this.setterFn||(this.setterFn=
J(this.code)),this.setterFn(this.obj,a);else if("array"==b)this.obj=a;else throw"Cannot set value";},onInputParamChange:function(){this.setValue(this.lastSetValue)},onPipeParamChange:function(){this.check()},check:function(){switch(this.type){case "expr":case "attr":case "static":return this._checkCode();case "object":return this._checkObject();case "array":return this._checkArray()}return!1},checkAll:function(){return this.obj.$$watchers.$checkAll()},getLastResult:function(){return this.curr},setInterval:function(a){var b=
this;b.itv&&b.clearInterval();b.itv=setInterval(function(){b.check()},a)},clearInterval:function(){this.itv&&(clearInterval(this.itv),this.itv=null)},unsubscribeAndDestroy:function(a,b){var c=this.id;a&&e.un(c,a,b);return e.hasListener(c)?!1:(this.destroy(),!0)},destroy:function(){var a=this.pipes,b=this.inputPipes,c,d,f,k,g;this.itv&&this.clearInterval();if(a)for(c=-1,d=a.length;++c<d;)for(g=a[c][2],f=-1,k=g.length;++f<k;)g[f].unsubscribeAndDestroy(this.check,this);if(b)for(c=-1,d=b.length;++c<d;)for(g=
b[c][2],f=-1,k=g.length;++f<k;)g[f].unsubscribeAndDestroy(this.onInputParamChange,this);this.obj&&delete this.obj.$$watchers[this.origCode];delete this.id;delete this.curr;delete this.prev;delete this.unfiltered;delete this.obj;delete this.pipes;delete this.inputPipes;delete this.origCode;delete this.code;delete this.getterFn;delete this.setterFn;delete this.lastSetValue;delete this.staticValue;delete this.userData;delete this.namespace;delete this.nsGet;e.destroyEvent(this.id)}};var r=function(a,
b,c,e,f,k){b=m(a,p(b));return a?(a.$$watchers||(a.$$watchers={$checkAll:function(){var a,b=0;for(a in this)"$"!=a.charAt(0)&&this[a].check()?b++:"$"==a.charAt(0)&&this[a]instanceof d&&this[a].check()&&b++;return b},$destroyAll:function(){for(var a in this)if("$"!=a.charAt(0)||this[a]instanceof d)this[a].destroy(),delete this[a]}}),a.$$watchers[b]?a.$$watchers[b].subscribe(c,e,{append:[f],allowDupes:!0}):a.$$watchers[b]=new d(a,b,c,e,f,k),a.$$watchers[b]):new d(a,b,c,e,f,k)},m=function(a,b){if(a&&
b){if(a.hasOwnProperty(b))return b;var c;if("."==b.charAt(0)&&(c=b.substr(1),a.hasOwnProperty(c)))return c}return b},q=Function,u=function(a,b,c,d){for(;c&&!c.$isRoot;)if(c=c.$parent)try{return 4==arguments.length?b.call(null,c,d,s,b):b.call(null,c,s,b)}catch(e){}null!==a&&w(a)},E=function(a,b){return function(){var c=t.call(arguments);c.push(u);c.push(a);c=a.apply(null,c);if(!b||void 0!==c&&8!=f(c))return c;c=t.call(arguments);c.unshift(a);c.unshift(null);return u.apply(null,c)}},x={},K=0,D=function(b){try{return x[b]?
x[b]:(K++,x[b]=E(new q("____","$$interceptor","$$itself","".concat("try {","return ",b.replace(a,"$1____.$3"),";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }")),!0))}catch(c){return w(c),s}},y={},L=0,J=function(b){try{if(!y[b]){L++;var c=b.replace(a,"$1____.$3");return y[b]=E(new q("____","$$$$","$$interceptor","$$itself","".concat("try {",c," = $$$$",";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____, $$$$); }")))}return y[b]}catch(d){return w(d),
s}},z={},M=0,I=function(a,c){var d;return(d=b(a))?d:D(a)(c)},B=function(){1E3<=K&&(x={});1E3<=L&&(y={});1E3<=M&&(z={})};d.create=r;d.unsubscribeAndDestroy=function(a,b,c,d){b=p(b);(a=a.$$watchers)&&a[b]&&a[b].unsubscribeAndDestroy(c,d)&&delete a[b]};d.normalizeExpr=m;d.prepareCode=function(b){return b.replace(a,"$1____.$3")};d.createGetter=D;d.createSetter=J;d.createFunc=function(b){try{return z[b]?z[b]:(M++,z[b]=E(new q("____","$$interceptor","$$itself","".concat("try {",b.replace(a,"$1____.$3"),
";} catch (thrownError) { return $$interceptor(thrownError, $$itself, ____); }"))))}catch(c){return w(c),s}};d.eval=I;d.enableResetCacheInterval=function(){setTimeout(B,1E4)};return d}();MetaphorJs.lib.Watchable=u;"undefined"!=typeof global?global.MetaphorJs=MetaphorJs:window.MetaphorJs=MetaphorJs})();
